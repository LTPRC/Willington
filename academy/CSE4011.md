# CSE401 - Spring - Spring框架

返回[Bulletin](./bulletin.md)

返回[CSE401 - Spring](./CSE401.md)

[TOC]

## Spring<img src="./icons/citic.gif" /><img src="./icons/baidu.gif" /><img src="./icons/gupao.gif" /><img src="./icons/meituan.gif" /><img src="./icons/netease.gif" />

Spring是分层的full-stack（全栈）开源框架，最初版本发布于2002年，以IoC和AOP为内核。

**轻量级 lightweight**

相比过去的Java EE, Spring是轻量的，基本的版本大约2MB。

**一站式 one-stop-shop**

整合了大量框架和工具。Spring对javaEE开发中非常难用的一些API（例如JDBC, javaMail, 远程调用等）都提供了封装，使这些API应用难度大大降低。

### 版本<img src="./icons/mashibing.gif" />

**Spring 5**

Spring Framework 5.x支持JDK 8.

- Spring接口中的默认方法

- 基于Java 8反射增强的内部代码改进

- 在框架代码中使用函数式编程-lambda表达式和stream流

**Spring 4**

Spring Framework 4.x支持JDK 6.

**Spring 3**

Spring Framework 3.x支持JDK 5.

### 模块

<img src="./images/CSE401001.png" />

**Spring Core模块**

Core模块是Spring的核心类库，Spring的所有功能都依赖于该类库。Core主要用来实现IOC功能，基本上Spring的所有功能都是借助IOC实现的。IOC容器实现了对象的创建、装配、和生命周期的管理。

**AOP模块**

AOP模块是Spring的AOP库，提供了AOP（拦截器）机制，以及可自行配置的常用拦截器。

**ORM模块**

ORM模块提供对常用的ORM框架，例如Hibernate，ibtas，jdao等框架的管理和辅助支持。

Spring本身并不对ORM进行实现，仅对常见的ORM框架进行封装和管理。

**DAO模块**

DAO模块可以执行SQL语句、提供对JDBC的支持。模块并不对JDBC进行实现，而是对JDBC进行封装并允许其使用Spring资源，并统一管理所有JDBC事物。

**WEB模块**

WEB模块提供对常见框架如Struts1，WEBWORK（Struts 2），JSF的支持，能够管理这些框架，将Spring的资源注入给框架，也能在这些框架的前后插入拦截器。

**Context模块**

Context模块提供框架式的Bean访问方式，其他程序可以通过Context访问Spring的Bean资源，相当于资源注入。

**MVC模块**

MVC模块为Spring提供了一套轻量级的MVC实现。相对于Struts，Spring自己的MVC框架更加简洁和方便。

### 优势

**方便解耦，简化开发**

通过Spring提供的IoC容器，可以将对象间的依赖关系交由Spring进⾏控制，避免硬编码所造成的过度程序耦合。⽤户也不必再为单例模式类、属性⽂件解析等这些很底层的需求编写代码，可以更专注于上层的应⽤。

**AOP编程的⽀持**

通过Spring的AOP功能，⽅便进⾏⾯向切⾯的编程，许多不容易⽤传统OOP实现的功能可以通过AOP轻松应付。

**声明式事务的⽀持**

@Transactional可以将我们从单调烦闷的事务管理代码中解脱出来，通过声明式方式灵活的进行事务的管理，提⾼开发效率和质量。

**方便程序的测试**

可以⽤⾮容器依赖的编程⽅式进⾏⼏乎所有的测试⼯作，测试不再是昂贵的操作，⽽是随⼿可做的事情。

**方便集成各种优秀框架**

Spring可以降低各种框架的使⽤难度，提供了对各种优秀框架（Struts、Hibernate、Hessian、Quartz等）的直接⽀持。

**降低JavaEE API的使用难度**

Spring对JavaEE API（如JDBC、JavaMail、远程调用等）进行了薄薄的封装层，使这些API的使用难度⼤为降低。

**源码是经典的Java学习范例**

Spring的源代码设计精妙、结构清晰、匠⼼独⽤，处处体现着⼤师对Java设计模式灵活运用以及对Java技术的⾼深造诣。它的源代码⽆意是Java技术的最佳实践的范例。

我们经常说的Spring其实指的是Spring Framework（spring框架）。

## 控制反转IoC<img src="./icons/baidu.gif" /><img src="./icons/sf.gif" /><img src="./icons/netease.gif" /><img src="./icons/pingan.gif" /><img src="./icons/miisi.gif" /><img src="./icons/citic.gif" /><img src="./icons/bbbbzxlb.gif" /><img src="./icons/gupao.gif" /><img src="./icons/alibaba.gif" /><img src="./icons/mashibing.gif" />

IoC叫控制反转(Inversion of Control), 是Spring的核心，指的是把传统上由程序代码直接操控的对象的调用权，交给**Spring容器**来控制对象的生命周期和对象间的关系。

<img src="./images/CSE401002.png" />

## Spring容器

Spring的核心理念就是更方便地管理Java Bean，而被管理的Java Bean存缓存在一个Map中，即IoC容器。

整个bean的生命周期，从创建到使用到销毁的过程全部都是由容器来管理（bean的生命周期）。

### 依赖注入Dependency Injection

是当前比较流行的控制反转Ioc的实现方式之一。将Bean安装在Bean容器中并进行依赖关系配置的过程被称为装配，IoC控制反转就是指的安装这一过程，而DI依赖指的是配置这一过程。Spring可以通过**构造方法注入**（一般用于强依赖）和**setter方法注入**（一般用于可选依赖）两种方式完成依赖注入。

<img src="./images/CSE401003.png" />

## Spring项目实战

### 创建标准工程<img src="./icons/mashibing.gif" />

按照惯例新建libs目录，引入以下jar包：

- commons-lang3-3.11.jar

- commons-logging-1.2.jar

- spring-beans-5.2.3.RELEASE.jar

- spring-context-5.2.3.RELEASE.jar

- spring-core-5.2.3.RELEASE.jar

- spring-expression-5.2.3.RELEASE.jar

准备Spring上下文配置文件src/applicationContext.xml

### 创建Maven工程<img src="./icons/mashibing.gif" />

在左侧Package Explorer点击右键，新建Maven工程。

生成的pom.xml如下所示

```xml
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.mashibing.spring</groupId>
  <artifactId>Spring01</artifactId>
  <version>0.0.1-SNAPSHOT</version>
  <name>spring stu</name>
</project>
```

登录[https://mvnrepository.com/artifact/org.springframework/](https://mvnrepository.com/artifact/org.springframework/spring-context) 

复制Maven下spring context和spring-core等依赖的xml dependency配置信息，到dependencies标签下。

```xml
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.mashibing.spring</groupId>
  <artifactId>Spring01</artifactId>
  <version>0.0.1-SNAPSHOT</version>
  <name>spring stu</name>
  
  <dependencies>
  
    <!-- https://mvnrepository.com/artifact/org.springframework/spring-context -->
    <dependency>
      <groupId>org.springframework</groupId>
      <artifactId>spring-context</artifactId>
      <version>5.3.2</version>
    </dependency>

    <!-- https://mvnrepository.com/artifact/org.springframework/spring-context -->
    <dependency>
      <groupId>org.springframework</groupId>
      <artifactId>spring-core</artifactId>
      <version>5.3.2</version>
    </dependency>
  </dependencies>
  
</project>
```

准备Spring上下文配置文件src/main/resources/applicationContext.xml